@model DMeServices.Models.ViewModels.Internal.Permits.PermitsViewModel
@{
    ViewBag.Title = "Permits";
    Layout = "~/Views/Shared/_SubLayout.cshtml";
    <script src="@Url.Content("~/Scripts/jquery.validate.min.js")"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")"></script>
    <script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")"></script>

}

<script>
    $(document).ready(function () {
        //    $('#oTable').DataTable({
        //        "language": {
        //            "info": "معاملات في الصفحة",
        //        }
        //    });

    });
</script>
<style>
    .radio-inline, .checkbox-inline {
        display: inline-block;
        padding-left: 2px;
        margin-bottom: 0;
        vertical-align: middle;
        font-weight: normal;
        cursor: pointer;
    }

    .NotComplete, .NotAgree, .Cancel, .Missing {
        color: red;
    }

    .WaitingPayment {
        color: brown;
    }

    .Pending, .Updated {
        color: orange;
    }

    .Paid, .New, .Completed, .Agree, .Accepted, .Ended {
        color: olivedrab;
    }

    .Paid, .Completed, .Agree, .Accepted {
        color: darkgreen;
    }

    .Ended {
        color: darkviolet,
    }
</style>
<div class="col-lg-12 col-sm-12">
    <div class="row">
        <div class="box col-md-12">
            <div class="box-inner">
                <div class="box-header well" data-original-title="">
                    <h2><i class="glyphicon glyphicon-road"></i> طلبات تراخيص البناء</h2>
                    @if (Model.oEmployeeInfo.IsEngineerHead)
                    {
                        <div style="font-size:12px;">



                            <div style="float:left ; padding-right:10px;">
                                <label class="radio-inline">الطلبات الغير مكتملة</label>
                                <input value="NotCompletePermits" type="radio" name="optradio" />
                            </div>

                            <div style="float:left ; padding-right:10px;">
                                <label class="radio-inline">الطلبات المقبولة</label>
                                <input value="AcceptedPermits" type="radio" name="optradio" />
                            </div>

                            <div style="float:left ; padding-right:10px;">
                                <label class="radio-inline">الطلبات المرفوضة</label>
                                <input value="CanceledPermits" type="radio" name="optradio" />
                            </div>



                            <div style="float:left ; padding-right:10px;">
                                <label class="radio-inline">جميع الطلبات</label>
                                <input value="AllPermits" type="radio" checked="checked" name="optradio" />
                            </div>
                            <div style="float:left ; padding-right:10px;">
                                <label class="radio-inline">الطلبات الجديدة</label>
                                <input value="NewPermits" type="radio" name="optradio" />
                            </div>
                        </div>
                    }


                </div>


                <div class="box-content">
                    <div id="divLoader" style="display:block;"> <img src="~/Content/ajax-loader.gif" alt="Loader" /> </div>

                    <table class="table table-striped table-bordered bootstrap-datatable datatable responsive" id="oTable">
                        <thead>
                            <tr>
                                <th>رقم المعاملة</th>
                                <th>اسم المكتب الاستشاري</th>
                                <th>اسم مالك المشروع</th>
                                <th>رقم البطاقة الشخصية للمالك</th>
                                <th>رقم قطعة الأرض</th>
                                <th>مربع رقم</th>
                                <th>المنطقة</th>
                                <th>تاريخ الطلب</th>
                                <th>حالة الطلب</th>

                                @if (Model.oEmployeeInfo.IsEngineerHead)
                                {
                                    <th>المهندس المختص</th>
                                }

                            </tr>
                        </thead>
                        <tbody id="PermitsList">
                            @{ Html.RenderPartial("_PermitsList", Model);}
                        </tbody>

                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
    $(document).ready(function () {
        $("#divLoader").hide();
        $('input[type="radio"]').click(function () {
            if ($(this).is(':checked')) {

            }
            var type = $(this).val();
            var url = "@Url.Action("PermitsList", "BuildingPermits")";

            $("#divLoader").show();
            $.ajax({
                url: url,
                type: 'POST',
                data: { Type: type },
                success: function (response) {
                    //$('#oTable').dataTable().api().ajax.reload();
                    $("#divLoader").hide();
                    $('#PermitsList').html(response);
                    //$('#oTable').dataTable().fnAddData(response);
                    //$('#oTable').dataTable().fnDraw();
                },
                error: function (er) {
                    $("#divLoader").hide();
                    console.log(er);
                }

            });

        });
    });
</script>